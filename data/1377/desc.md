**<center>NGUá»’N: Äá» thi chá»n Ä‘á»™i tuyá»ƒn HSGQG - ÄÃ  Láº¡t - NÄƒm 2019-2020</center>**

Cho $S$ lÃ  táº­p cÃ¡c Ä‘iá»ƒm cÃ³ tá»a Ä‘á»™ nguyÃªn trÃªn máº·t pháº³ng. CÃ³ ba thao tÃ¡c vá»›i táº­p Ä‘iá»ƒm Ä‘Ã£ cho:
- Thao tÃ¡c $1$: ThÃªm má»™t Ä‘iá»ƒm vÃ o $S$;
- Thao tÃ¡c $2$: Loáº¡i bá» má»™t Ä‘iá»ƒm ra khá»i táº­p $S$;
- Thao tÃ¡c $3$: Tráº£ lá»i cÃ¢u há»i:  Cho trÆ°á»›c má»™t Ä‘iá»ƒm, há»i diá»‡n tÃ­ch lá»›n nháº¥t cá»§a tam giÃ¡c vuÃ´ng láº¥y Ä‘iá»ƒm cho trÆ°á»›c lÃ m Ä‘á»‰nh gÃ³c vuÃ´ng, hai cáº¡nh bÃªn song song vá»›i hai trá»¥c tá»a Ä‘á»™ vÃ  hai Ä‘á»‰nh cÃ²n láº¡i cá»§a tam giÃ¡c thuá»™c táº­p Ä‘iá»ƒm trong táº­p $S$.

**YÃªu cáº§u:** Cho táº­p $S$ vÃ  dÃ£y gá»“m $q$ thao tÃ¡c, hÃ£y viáº¿t chÆ°Æ¡ng trÃ¬nh thá»±c hiá»‡n $q$ dÃ£y thao tÃ¡c Ä‘Ã£ cho vÃ  tráº£ lá»i cÃ¢u há»i khi thá»±c hiá»‡n thao tÃ¡c $3$.

## Dá»¯ liá»‡u vÃ o:
- DÃ²ng Ä‘áº§u ghi hai sá»‘ nguyÃªn $n$ vÃ  $q$, láº§n lÆ°á»£t lÃ  sá»‘ lÆ°á»£ng Ä‘iá»ƒm cá»§a táº­p $S$ lÃºc xuáº¥t phÃ¡t vÃ  sá»‘ lÆ°á»£ng thao tÃ¡c cáº§n thá»±c hiá»‡n $(3<n, q â‰¤ 10^5)$;
- Tiáº¿p theo lÃ  $n$ dÃ²ng, má»—i dÃ²ng ghi hai sá»‘ nguyÃªn lÃ  tá»a Ä‘á»™ má»™t Ä‘iá»ƒm trong táº­p $S$;
- Tiáº¿p theo lÃ  $q$ dÃ²ng, má»—i dÃ²ng trong sá»‘ cÃ¡c dÃ²ng nÃ y, chá»©a thÃ´ng tin má»™t thao tÃ¡c cáº§n thá»±c hiá»‡n. cÃ³ má»™t trong ba dáº¡ng nhÆ° sau:
    - $1\ x\ y$: YÃªu cáº§u thá»±c hiá»‡n thao tÃ¡c $1$, bá»• sung Ä‘iá»ƒm cÃ³ tá»a Ä‘á»™ $(x, y)$ vÃ o táº­p $S$;
    - $2\ x\ y$: YÃªu cáº§u thá»±c hiá»‡n thao tÃ¡c $2$, loáº¡i bá» Ä‘iá»ƒm cÃ³ tá»a Ä‘á»™ $(x, y)$ ra khá»i táº­p $S$;
    - $3\ x\ y$: YÃªu cáº§u thá»±c hiá»‡n thao tÃ¡c $3$, vá»›i Ä‘iá»ƒm cho trÆ°á»›c cÃ³ tá»a Ä‘á»™ $(x,y)$;

Äá»‘i vá»›i thao tÃ¡c $2$, dá»¯ liá»‡u Ä‘áº£m báº£o ráº±ng Ä‘iá»ƒm tá»a Ä‘á»™ $(x, y)$ cÃ³ trong táº­p $S$ vÃ  dá»¯ liá»‡u Ä‘Ã£m báº£o á»Ÿ báº¥t cá»© thá»i Ä‘iá»ƒm nÃ o, táº­p $S$ khÃ´ng chá»©a hai Ä‘iá»ƒm trÃ¹ng nhau. $( 0< x, y â‰¤ 10^9)$.

## Dá»¯ liá»‡u ra:
- Äá»‘i vá»›i thao tÃ¡c $3$, hÃ£y Ä‘Æ°a ra trÃªn má»™t dÃ²ng má»™t sá»‘ nguyÃªn hoáº·c sá»‘ thá»±c cÃ³ má»™t chá»¯ sá»‘ tháº­p phÃ¢n (náº¿u káº¿t quáº£ khÃ´ng lÃ  sá»‘ nguyÃªn). Náº¿u khÃ´ng cÃ³ tam giÃ¡c vuÃ´ng nÃ o thá»a máº£ng cÃ¡c tÃ­nh cháº¥t nhÆ° Ä‘Ã£ nÃªu thÃ¬ xuáº¥t ra káº¿t quáº£ lÃ  $0$.

## VÃ­ dá»¥:
### Dá»¯ liá»‡u vÃ o:
```
7 10
1 1
1 4
2 3
2 4
3 2
4 4
-3 6
3 1 2
3 3 4
2 1 4
3 3 4
1 7 4
3 3 4
3 1 2
3 4 1
2 1 1
3 1 2
```

### Dá»¯ liá»‡u ra:
```
2
2
1
4
1
4.5
0
```

### Giáº£i thÃ­ch:
***<center><img src="/images/problems/1377/TRIANGLE.png" width="600px" /> <br>HÃ¬nh minh há»a</center>***

Káº¿t quáº£ cÃ¡c thao tÃ¡c $3$ nhÆ° sau:
- $(1,2) (3, 2) (1,4)$;
- $(3, 4) (3,2) (1, 4)$;
- $(3, 4) (3,2) ((2, 4)\text{ hoáº·c }(4,4))$;
- $(3, 4) (3,2) ((7, 4)$;
- $(1, 2) (1, 1) (3, 2)$;
- $(4, 1) (1,1) (4, 4)$;
- KhÃ´ng cÃ³ tam giÃ¡c;

## Giá»›i háº¡n:
+ Subtask $\#1: 60\%$ sá»‘ Ä‘iá»ƒm cá»§a bÃ i cÃ³ $3< ğ‘›, q â‰¤ 10^3$; 
+ Subtask $\#2: 40\%$ sá»‘ Ä‘iá»ƒm cá»§a bÃ i cÃ³  $10^3< ğ‘›, q â‰¤ 10^5$.