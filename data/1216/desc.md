**<center>Nguแปn: รn HN thรกng 11/2017, Thแบงy Lรช Minh Hoรng, Ngรy 1</center>**

Mแปt dรฃy dแบฅu ngoแบทc ฤรบng lร mแปt dรฃy cรกc kรฝ tแปฑ `(` vร `)` ฤฦฐแปฃc ฤแปnh nghฤฉa nhฦฐ sau:
- Dรฃy rแปng (khรดng cรณ kรฝ tแปฑ nรo) lร mแปt dรฃy dแบฅu ngoแบทc ฤรบng;
- Nแบฟu ~A~ lร mแปt dรฃy dแบฅu ngoแบทc ฤรบng thรฌ ~(A)~ lร dรฃy dแบฅu ngoแบทc ฤรบng. Dแบฅu ngoแบทc mแป vร dแบฅu ngoแบทc ฤรณng hai bรชn 
dรฃy ~A~ ฤฦฐแปฃc gแปi lร tฦฐฦกng แปฉng vแปi nhau;
- Nแบฟu ~A~ vร ~B~ lร hai dรฃy dแบฅu ngoแบทc ฤรบng thรฌ ~AB~ lร dรฃy dแบฅu ngoแบทc ฤรบng.

Cho xรขu kรฝ tแปฑ ~๐ = ๐_1๐_2 โฆ ๐_๐~ chแป gแปm cรกc kรฝ tแปฑ `(` vร `)`, xรฉt mแปt dรฃy gแปm ~๐~ thao tรกc thuแปc mแปt trong hai dแบกng:
- ~C\ ๐:~ Nแบฟu kรฝ tแปฑ ~๐_๐~ ฤang lร dแบฅu mแป ngoแบทc (, nรณ sแบฝ ฤฦฐแปฃc thay bแปi dแบฅu ฤรณng ngoแบทc `)` vร ngฦฐแปฃc lแบกi, nแบฟu kรฝ tแปฑ ~๐_๐~ 
ฤang lร dแบฅu ฤรณng ngoแบทc, nรณ sแบฝ ฤฦฐแปฃc thay bแบฑng dแบฅu mแป ngoแบทc.
- ~Q\ ๐:~ Cho biแบฟt ฤแป dรi dรฃy ngoแบทc ฤรบng dรi nhแบฅt tแบกo thรnh tแปซ cรกc kรฝ tแปฑ liรชn tiแบฟp trong xรขu ~๐~ bแบฏt ฤแบงu tแปซ vแป trรญ ~๐~. Tแปฉc 
lร tรฌm ฤแป dรi ~๐~ lแปn nhแบฅt mร xรขu ~๐_๐๐_{๐+1} โฆ ๐_{๐+๐โ1}~ lร mแปt dรฃy ngoแบทc ฤรบng.

**Yรชu cแบงu:** Hรฃy trแบฃ lแปi tแบฅt cแบฃ cรกc truy vแบฅn loแบกi ~Q~.

## Dแปฏ liแปu vรo:
- Dรฒng ฤแบงu chแปฉa xรขu kรฝ tแปฑ ~๐~ ฤแป dรi ~๐ โค 10^6~;
- Dรฒng thแปฉ hai chแปฉa sแป nguyรชn dฦฐฦกng ~๐ โค 10^6~ lร sแป thao tรกc;
 - ~๐~ dรฒng tiแบฟp theo, mแปi dรฒng chแปฉa kรฝ tแปฑ ฤแบงu dรฒng ~โ \{C,Q\}~ cho biแบฟt loแบกi thao tรกc, tiแบฟp theo lร dแบฅu cรกch vร mแปt sแป 
nguyรชn ~๐~ chแป ra vแป trรญ tฦฐฦกng แปฉng vแปi thao tรกc ~(1 โค ๐ โค ๐)~.

## Dแปฏ liแปu ra:
- รng vแปi mแปi thao tรกc ~Q~ ghi ra mแปt sแป nguyรชn duy nhแบฅt lร kแบฟt quแบฃ trแบฃ lแปi trรชn mแปt dรฒng.

## Vรญ dแปฅ:
#### Dแปฏ liแปu vรo:
```
)((())()
6
Q 3
C 7
Q 2
Q 1
C 1
Q 1
```

#### Dแปฏ liแปu ra:
```
6
6
0
8
```