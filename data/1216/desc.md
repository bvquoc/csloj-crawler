**<center>Nguá»“n: Ã”n HN thÃ¡ng 11/2017, Tháº§y LÃª Minh HoÃ ng, NgÃ y 1</center>**

Má»™t dÃ£y dáº¥u ngoáº·c Ä‘Ãºng lÃ  má»™t dÃ£y cÃ¡c kÃ½ tá»± `(` vÃ  `)` Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a nhÆ° sau:
- DÃ£y rá»—ng (khÃ´ng cÃ³ kÃ½ tá»± nÃ o) lÃ  má»™t dÃ£y dáº¥u ngoáº·c Ä‘Ãºng;
- Náº¿u ~A~ lÃ  má»™t dÃ£y dáº¥u ngoáº·c Ä‘Ãºng thÃ¬ ~(A)~ lÃ  dÃ£y dáº¥u ngoáº·c Ä‘Ãºng. Dáº¥u ngoáº·c má»Ÿ vÃ  dáº¥u ngoáº·c Ä‘Ã³ng hai bÃªn 
dÃ£y ~A~ Ä‘Æ°á»£c gá»i lÃ  tÆ°Æ¡ng á»©ng vá»›i nhau;
- Náº¿u ~A~ vÃ  ~B~ lÃ  hai dÃ£y dáº¥u ngoáº·c Ä‘Ãºng thÃ¬ ~AB~ lÃ  dÃ£y dáº¥u ngoáº·c Ä‘Ãºng.

Cho xÃ¢u kÃ½ tá»± ~ğ‘† = ğ‘ _1ğ‘ _2 â€¦ ğ‘ _ğ‘›~ chá»‰ gá»“m cÃ¡c kÃ½ tá»± `(` vÃ  `)`, xÃ©t má»™t dÃ£y gá»“m ~ğ‘š~ thao tÃ¡c thuá»™c má»™t trong hai dáº¡ng:
- ~C\ ğ‘–:~ Náº¿u kÃ½ tá»± ~ğ‘ _ğ‘–~ Ä‘ang lÃ  dáº¥u má»Ÿ ngoáº·c (, nÃ³ sáº½ Ä‘Æ°á»£c thay bá»Ÿi dáº¥u Ä‘Ã³ng ngoáº·c `)` vÃ  ngÆ°á»£c láº¡i, náº¿u kÃ½ tá»± ~ğ‘ _ğ‘–~ 
Ä‘ang lÃ  dáº¥u Ä‘Ã³ng ngoáº·c, nÃ³ sáº½ Ä‘Æ°á»£c thay báº±ng dáº¥u má»Ÿ ngoáº·c.
- ~Q\ ğ‘–:~ Cho biáº¿t Ä‘á»™ dÃ i dÃ£y ngoáº·c Ä‘Ãºng dÃ i nháº¥t táº¡o thÃ nh tá»« cÃ¡c kÃ½ tá»± liÃªn tiáº¿p trong xÃ¢u ~ğ‘†~ báº¯t Ä‘áº§u tá»« vá»‹ trÃ­ ~ğ‘–~. Tá»©c 
lÃ  tÃ¬m Ä‘á»™ dÃ i ~ğ‘˜~ lá»›n nháº¥t mÃ  xÃ¢u ~ğ‘ _ğ‘–ğ‘ _{ğ‘–+1} â€¦ ğ‘ _{ğ‘–+ğ‘˜âˆ’1}~ lÃ  má»™t dÃ£y ngoáº·c Ä‘Ãºng.

**YÃªu cáº§u:** HÃ£y tráº£ lá»i táº¥t cáº£ cÃ¡c truy váº¥n loáº¡i ~Q~.

## Dá»¯ liá»‡u vÃ o:
- DÃ²ng Ä‘áº§u chá»©a xÃ¢u kÃ½ tá»± ~ğ‘†~ Ä‘á»™ dÃ i ~ğ‘› â‰¤ 10^6~;
- DÃ²ng thá»© hai chá»©a sá»‘ nguyÃªn dÆ°Æ¡ng ~ğ‘š â‰¤ 10^6~ lÃ  sá»‘ thao tÃ¡c;
 - ~ğ‘š~ dÃ²ng tiáº¿p theo, má»—i dÃ²ng chá»©a kÃ½ tá»± Ä‘áº§u dÃ²ng ~âˆˆ \{C,Q\}~ cho biáº¿t loáº¡i thao tÃ¡c, tiáº¿p theo lÃ  dáº¥u cÃ¡ch vÃ  má»™t sá»‘ 
nguyÃªn ~ğ‘–~ chá»‰ ra vá»‹ trÃ­ tÆ°Æ¡ng á»©ng vá»›i thao tÃ¡c ~(1 â‰¤ ğ‘– â‰¤ ğ‘›)~.

## Dá»¯ liá»‡u ra:
- Ãšng vá»›i má»—i thao tÃ¡c ~Q~ ghi ra má»™t sá»‘ nguyÃªn duy nháº¥t lÃ  káº¿t quáº£ tráº£ lá»i trÃªn má»™t dÃ²ng.

## VÃ­ dá»¥:
#### Dá»¯ liá»‡u vÃ o:
```
)((())()
6
Q 3
C 7
Q 2
Q 1
C 1
Q 1
```

#### Dá»¯ liá»‡u ra:
```
6
6
0
8
```
**Nguá»“n:** [ChuyÃªn SÆ¡n La Online Judge](http://csloj.ddns.net/)

**Group giáº£i Ä‘Ã¡p tháº¯c máº¯c:** [Láº­p trÃ¬nh 24h](https://www.facebook.com/groups/1386904321519984)