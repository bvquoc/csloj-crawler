**<center>NGUá»’N: PVH PreVOI ONLINE 2020 (13 - 14/12/2019)</center>**
<br>

**ChÃº Ã½**: *Nhá»¯ng nhÃ¢n váº­t vÃ  tÃ¬nh tiáº¿t dÆ°á»›i Ä‘Ã¢y phá»ng theo má»™t tiá»ƒu thuyáº¿t khÃ´ng cÃ³ tháº­t trÃªn máº¡ng internet. Má»i sá»± tÆ°Æ¡ng Ä‘á»“ng vá»›i nhá»¯ng cÃ¡ nhÃ¢n cÃ³ tháº­t, náº¿u cÃ³, Ä‘á»u lÃ  trÃ¹ng há»£p ngáº«u nhiÃªn. CÃ¡c báº¡n cÃ³ thá»ƒ tham kháº£o thÃªm táº¡i [Ä‘Ã¢y](https://www.wattpad.com/269174134-t%C3%ACnh-b%E1%BA%A1n-v%C3%A0-t%C3%ACnh-y%C3%AAu-gi%E1%BB%9Bi-thi%E1%BB%87u-nh%C3%A2n-v%E1%BA%ADt).*

Admin tráº» tuá»•i nhÃ¢Ìt cá»§a cá»™ng Ä‘á»“ng Vinoy  â€” VLT  â€” sinh ra trong gia tá»™c V.L. danh gia voÌ£ng tá»™c Ä‘á»©ng thá»© ~2~ tháº¿ giÆ¡Ìi chá»‰ sau gia tá»™c N.H. Trong truyá»‡n, cáº­u Ä‘Æ°Æ¡Ì£c miÃªu táº£ má»™t cÃ¡ch vÃ´ cÃ¹ng hÆ° cÃ¢Ìu nhÆ° sau:

*Ngoáº¡i hÃ¬nh : soÃ¡i ca, vÃ´ cÃ¹ng Ä‘áº¹p trai cao 1 mÃ©t 86 Ä‘Ã´i máº¯t há»• phÃ¡ch mÃ¡i tÃ³c báº¡ch kim*
*TÃ­nh cÃ¡ch : láº¡nh lÃ¹ng thá» Æ¡ chá»‰ bÃªn ngÆ°á»i thÃ¢n má»›i áº¥m Ã¡p vÃ  ráº¥t yÃªu nÃ³, siÃªu quáº­y*
*IQ : ~300/300~ giá»i táº¥t cáº£ cÃ¡c loáº¡i vÃµ chuyÃªn vá» sá»­ dá»¥ng sÃºng vÃ  cháº¿ táº¡o vÅ© khÃ­*

Gáº§n Ä‘Ã¢y, VLT vá»«a khÃ¡m phÃ¡ ra má»™t vÄƒn tá»± cá»• xÆ°a, nghi rÄƒÌ€ng coÌ liÃªn quan Ä‘áº¿n gia tá»™c V.L. ÄÃ¡ng ngaÌ£c nhiÃªn lÃ  vÄƒn tá»± nÃ y laÌ£i Ä‘Æ°Æ¡Ì£c viáº¿t bÄƒÌ€ng báº£ng chá»¯ cÃ¡i Latin in thÆ°á»ng. Ngay láº­p tá»©c, VLT báº¯t tay vÃ o viá»‡c giáº£i mÃ£ vÄƒn tá»± nÃ y. VÆ¡Ìi IQ ~300/300~ cá»§a mÃ¬nh, VLT suy luáº­n rÄƒÌ€ng manh má»‘i cháº¯c cháº¯n nÄƒÌ€m á»Ÿ má»™t Ä‘oaÌ£n liÃªn tiáº¿p cá»§a vÄƒn tá»± vÃ  coÌ liÃªn quan Ä‘áº¿n tÃªn cá»§a má»™t trong cÃ¡c tá»• tiÃªn cá»§a mÃ¬nh. TÃ¢Ìt nhiÃªn,VLT Ä‘Ã£ coÌ sáºµn gia pháº£ bao gá»“m tÃªn cá»§a ~ğ‘›~ tá»• tiÃªn thuá»™c gia tá»™c V.L. NhÆ° má»™t truyá»n thá»‘ng, thÃ nh viÃªn thá»© ğ‘– gia tá»™c V.L. Ä‘Æ°Æ¡Ì£c Ä‘ÄƒÌ£t tÃªn giá»‘ng vÆ¡Ìi tÃªn cá»§a má»™t tá»• tiÃªn ~ğ‘¥_ğ‘–~ trÆ°Æ¡Ìc Ä‘oÌ, gheÌp vÆ¡Ìi "tÃªn riÃªng" lÃ  má»™t xÃ¢u ~ğ‘ _ğ‘–~ khÃ´ng rÃ´Ìƒng gá»“m cÃ¡c chá»¯ cÃ¡i Latin viáº¿t thÆ°á»ng. VÃ­ dá»¥, náº¿u tá»• tiÃªn thá»© nhÃ¢Ìt cÃ³ tÃªn lÃ  `ğ‘£ğ‘¢ğ‘œğ‘›ğ‘”`, ~ğ‘¥_2 = 1, ğ‘ _2 =~ `ğ‘™ğ‘œğ‘›ğ‘”` thÃ¬ tá»• tiÃªn thá»© hai sáº½ cÃ³ tÃªn lÃ  `ğ‘£ğ‘¢ğ‘œğ‘›ğ‘”ğ‘™ğ‘œğ‘›ğ‘”`. TÆ°Æ¡ng tá»±, náº¿u ~ğ‘¥_3 = 2, ğ‘ _3 =~ `ğ‘¡ğ‘œğ‘ğ‘›` thÃ¬ tá»• tiÃªn thá»© ba sáº½ cÃ³ tÃªn lÃ  `ğ‘£ğ‘¢ğ‘œğ‘›ğ‘”ğ‘™ğ‘œğ‘›ğ‘”ğ‘¡ğ‘œğ‘ğ‘›`. 

VÃ¢Ìn Ä‘á» duy nhÃ¢Ìt cÃ²n laÌ£i lÃ  VLT khÃ´ng cháº¯c lÃ  manh má»‘i nÄƒÌ€m á»Ÿ Ä‘oaÌ£n nÃ o cá»§a vÄƒn tá»±, do Ä‘oÌ cáº­u choÌ£n ra ~ğ‘~ Ä‘oaÌ£n vÄƒn, Ä‘oaÌ£n thá»© ~ğ‘–~ gá»“m cÃ¡c kÃ­ tá»± thá»© tá»« ~ğ‘™_ğ‘–~ tÆ¡Ìi ~ğ‘Ÿ_ğ‘–~ cá»§a vÄƒn tá»±. VÆ¡Ìi mÃ´Ìƒi Ä‘oaÌ£n vÄƒn, VLT muá»‘n biáº¿t sá»‘ thá»© tá»± cá»§a tá»• tiÃªn cÃ³ tÃªn cÃ³ thá»© tá»± tá»« Ä‘iá»ƒn lÆ¡Ìn nhÃ¢Ìt nhÆ°ng khÃ´ng lÆ¡Ìn hÆ¡n Ä‘oaÌ£n vÄƒn Ä‘ang xeÌt.

NhÄƒÌc laÌ£i, xÃ¢u kyÌ tá»± ~ğ‘  = ğ‘ _1ğ‘ _2 â€¦ ğ‘ _ğ‘š~ coÌ thá»© tá»± tá»« Ä‘iá»ƒn nhá» hÆ¡n xÃ¢u kyÌ tá»± ~ğ‘¡ = ğ‘¡_1ğ‘¡_2 â€¦ ğ‘¡_ğ‘›~ khi vÃ  chá»‰ khi má»™t trong hai Ä‘iá»u kiá»‡n sau Ä‘Æ°Æ¡Ì£c thoáº£ mÃ£n:
 - ~ğ‘š < ğ‘›~ vÃ  ~ğ‘ _1 = ğ‘¡_1, ğ‘ _2 = ğ‘¡_2, â€¦ , ğ‘ _ğ‘š = ğ‘¡_ğ‘š~. NoÌi cÃ¡ch khÃ¡c, ~ğ‘ ~ lÃ  má»™t tiá»n tá»‘ thá»±c sá»± cá»§a ~ğ‘¡~. 
- Tá»“n taÌ£i chá»‰ sá»‘ ~ğ‘–~ thoáº£ mÃ£n ~ğ‘– < \min(ğ‘š, ğ‘›), ğ‘ _1 = ğ‘¡_1, ğ‘ _2 = ğ‘¡_2, â€¦ , ğ‘ _ğ‘– = ğ‘¡_ğ‘–~ vÃ  ~ğ‘ _{ğ‘–+1} < ğ‘¡_{ğ‘–+1}.~

## Dá»¯ liá»‡u vÃ o:
- DoÌ€ng Ä‘áº§u tiÃªn chá»©a sá»‘ nguyÃªn ~T~ ~(1 â‰¤ T â‰¤ 4)~ lÃ  sá»‘ thá»© tá»± cá»§a subtask chá»©a test nÃ y. 
- DoÌ€ng thá»© hai chá»©a xÃ¢u kyÌ tá»± gá»“m tá»« ~1~ tÆ¡Ìi ~5 \times 10^5~ chá»¯ cÃ¡i in thÆ°á»ng thá»ƒ hiá»‡n vÄƒn tá»± cá»• xÆ°a mÃ  VLT khÃ¡m phÃ¡ Ä‘Æ°Æ¡Ì£c.
- DoÌ€ng thá»© ba chá»©a sá»‘ nguyÃªn ~n~ ~(1 â‰¤ n â‰¤ 3 \times 10^5)~ lÃ  sá»‘ tá»• tiÃªn thuá»™c gia tá»™c V.L.
- Trong ~n~ doÌ€ng tiáº¿p theo, doÌ€ng thá»© ~i~ chá»©a sá»‘ nguyÃªn ~x_i~ ~(0 â‰¤ x_i < i)~ vÃ  xÃ¢u kyÌ tá»± ~s_i~ (gá»“m tá»« ~1~ tÆ¡Ìi ~5 \times 10^5~ chá»¯ cÃ¡i in thÆ°á»ng), cho biáº¿t tÃªn cá»§a thÃ nh viÃªn thá»© ~i~ trong gia tá»™c Ä‘Æ°Æ¡Ì£c taÌ£o ra bÄƒÌ€ng cÃ¡ch gheÌp tÃªn cá»§a thÃ nh viÃªn thá»© ~x_i~ vÆ¡Ìi tÃªn riÃªng ~s_i~. Náº¿u ~x_i = 0~, tÃªn cá»§a thÃ nh viÃªn thá»© ~i~ chiÌnh lÃ  ~s_i~. Tá»•ng Ä‘á»™ dÃ i cá»§a cÃ¡c xÃ¢u ~s_1, s_2, â€¦ , s_n~ khÃ´ng quÃ¡ ~5 \times 10^5~.
- DoÌ€ng tiáº¿p theo chá»©a sá»‘ nguyÃªn ~q~ ~(1 â‰¤ q â‰¤ 3 \times 10^5)~ lÃ  sá»‘ Ä‘oaÌ£n vÄƒn mÃ  VLT quan tÃ¢m.
- Trong ~q~ doÌ€ng cuá»‘i cÃ¹ng, doÌ€ng thá»© ~i~ chá»©a hai sá»‘ nguyÃªn ~l_i~ vÃ  ~r_i~ ~(1 â‰¤ l_i â‰¤ r_i â‰¤ p)~ vÆ¡Ìi ~p~ lÃ  Ä‘á»™ dÃ i vÄƒn tá»± cá»•, cho biáº¿t Ä‘oaÌ£n vÄƒn thá»© ~i~ Ä‘Æ°Æ¡Ì£c taÌ£o ra bá»Ÿi cÃ¡ch lÃ¢Ìy cÃ¡c kyÌ tá»± tá»« viÌ£ triÌ ~l_i~ tÆ¡Ìi viÌ£ triÌ ~r_i~ cá»§a vÄƒn tá»± cá»•. CÃ¡c kyÌ tá»± Ä‘Æ°Æ¡Ì£c Ä‘Ã¡nh sá»‘ tá»« ~1~.

## Dá»¯ liá»‡u ra:
- Gá»“m ~ğ‘~ doÌ€ng, doÌ€ng thá»© ~ğ‘–~ chá»©a má»™t sá»‘ nguyÃªn duy nhÃ¢Ìt lÃ  sá»‘ thá»© tá»± cá»§a tá»• tiÃªn coÌ tÃªn coÌ thá»© tá»± tá»« Ä‘iá»ƒn lÆ¡Ìn nhÃ¢Ìt nhÆ°ng khÃ´ng lÆ¡Ìn hÆ¡n Ä‘oaÌ£n vÄƒn thá»© ~ğ‘–~. Náº¿u nhiá»u tá»• tiÃªn cÃ¹ng thoáº£ mÃ£n Ä‘iá»u kiá»‡n nÃ y, in ra sá»‘ thá»© tá»± cá»§a tá»• tiÃªn coÌ sá»‘ thá»© tá»± nhá» nhÃ¢Ìt. Náº¿u khÃ´ng coÌ tá»• tiÃªn nÃ o thoáº£ mÃ£n, in ra ~âˆ’1~. CÃ¡c tá»• tiÃªn Ä‘Æ°Æ¡Ì£c Ä‘Ã¡nh sá»‘ tá»« ~1~ tÆ¡Ìi ~ğ‘›~.

## Giá»›i háº¡n:
- **Subtask** ~\#1~ ~(10\%\text{ sá»‘ Ä‘iá»ƒm}): ğ‘›, ğ‘ â‰¤ 2000~. VÄƒn tá»± cá»• vÃ  tÃªn cá»§a mÃ´Ìƒi ngÆ°á»i trong doÌ€ng hoÌ£ coÌ khÃ´ng quÃ¡ ~2000~ kiÌ tá»±
- **Subtask** ~\#2~ ~(25\%\text{ sá»‘ Ä‘iá»ƒm}):~ Tá»•ng Ä‘á»™ dÃ i cá»§a ~ğ‘~ Ä‘oaÌ£n vÄƒn tá»± cáº§n xeÌt ~(~tá»•ng cá»§a cÃ¡c ~ğ‘Ÿ_ğ‘– âˆ’ ğ‘™_ğ‘– + 1)~ khÃ´ng quÃ¡ ~10^7~
- **Subtask** ~\#3~ ~(30\%\text{ sá»‘ Ä‘iá»ƒm}): ğ‘¥_1 = ğ‘¥_2 = â‹¯ = ğ‘¥_ğ‘› = 0~
- **Subtask** ~\#4~ ~(35\%\text{ sá»‘ Ä‘iá»ƒm}):~ KhÃ´ng coÌ rÃ ng buá»™c giÌ€ thÃªm.

## VÃ­ dá»¥:
#### Dá»¯ liá»‡u vÃ o:
```
2
vuonglongtoanatgmaildotcomorz
6
0 vuong
1 long
2 tu
1 hoang
2 toan
4 long
6
1 13
1 4
1 6
14 26
29 29
1 8
```

#### Dá»¯ liá»‡u ra:
```
5
-1
6
-1
3
6
```

#### Dá»¯ liá»‡u vÃ o:
```
1
aaabcbdaac
6
0 a
1 bc
0 ab
3 c
3 ab
1 ab
6
1 3
3 5
2 2
8 10
10 10
9 10
```

#### Dá»¯ liá»‡u ra:
```
1
2
1
6
2
2
```

#### Giáº£i thÃ­ch:
Trong viÌ dá»¥ Ä‘áº§u tiÃªn, ~6~ tá»• tiÃªn trong gia tá»™c láº§n lÆ°Æ¡Ì£t coÌ tÃªn lÃ  `ğ‘£ğ‘¢ğ‘œğ‘›ğ‘”`, `ğ‘£ğ‘¢ğ‘œğ‘›ğ‘”ğ‘™ğ‘œğ‘›ğ‘”`, 
`ğ‘£ğ‘¢ğ‘œğ‘›ğ‘”ğ‘™ğ‘œğ‘›ğ‘”ğ‘¡ğ‘¢`, `ğ‘£ğ‘¢ğ‘œğ‘›ğ‘”â„ğ‘œğ‘ğ‘›ğ‘”`, `ğ‘£ğ‘¢ğ‘œğ‘›ğ‘”ğ‘™ğ‘œğ‘›ğ‘”ğ‘¡ğ‘œğ‘ğ‘›`, `ğ‘£ğ‘¢ğ‘œğ‘›ğ‘”â„ğ‘œğ‘ğ‘›ğ‘”ğ‘™ğ‘œğ‘›ğ‘”`. CÃ¡c tá»• tiÃªn sáº¯p xáº¿p theo thá»© tá»± tÄƒng dáº§n cá»§a tÃªn lÃ  ~(1, 4, 6, 2, 5, 3)~.
- ÄoaÌ£n vÄƒn cáº§n xeÌt thá»© nhÃ¢Ìt lÃ  `ğ‘£ğ‘¢ğ‘œğ‘›ğ‘”ğ‘™ğ‘œğ‘›ğ‘”ğ‘¡ğ‘œğ‘ğ‘›`. Tá»• tiÃªn sá»‘ ~5~ trÃ¹ng vÆ¡Ìi Ä‘oaÌ£n vÄƒn nÃ y.
- ÄoaÌ£n vÄƒn cáº§n xeÌt thá»© hai lÃ  `ğ‘£ğ‘¢ğ‘œğ‘›`. TÃ¢Ìt cáº£ ~6~ tá»• tiÃªn coÌ tÃªn coÌ thá»© tá»± tá»« Ä‘iá»ƒn lÆ¡Ìn hÆ¡n.

Trong viÌ dá»¥ thá»© hai, ~6~ tá»• tiÃªn trong gia tá»™c láº§n lÆ°Æ¡Ì£t coÌ tÃªn lÃ  `ğ‘`, `ğ‘ğ‘ğ‘`, `ğ‘ğ‘`, `ğ‘ğ‘ğ‘`, `ğ‘ğ‘ğ‘ğ‘`, `ğ‘ğ‘ğ‘`.
- ÄoaÌ£n vÄƒn thá»© hai cáº§n xeÌt lÃ  `ğ‘ğ‘ğ‘`. Tá»• tiÃªn sá»‘ ~2~ vÃ  sá»‘ ~4~ Ä‘á»u coÌ tÃªn coÌ thá»© tá»± tá»« Ä‘iá»ƒn lÆ¡Ìn nhÃ¢Ìt khÃ´ng quÃ¡ Ä‘oaÌ£n vÄƒn. Do Ä‘oÌ ~2~ Ä‘Æ°Æ¡Ì£c in ra viÌ€ coÌ chá»‰ sá»‘ nhá» hÆ¡n.
**Nguá»“n:** [ChuyÃªn SÆ¡n La Online Judge](http://csloj.ddns.net/)

**Group giáº£i Ä‘Ã¡p tháº¯c máº¯c:** [Láº­p trÃ¬nh 24h](https://www.facebook.com/groups/1386904321519984)