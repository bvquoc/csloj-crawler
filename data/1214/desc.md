**<center>Nguá»“n: Ã”n HN thÃ¡ng 11/2017, Tháº§y LÃª Minh HoÃ ng, NgÃ y 1</center>**

Má»™t mÃª cung gá»“m $ğ‘›$ Ä‘á»‹a Ä‘iá»ƒm Ä‘Ã¡nh sá»‘ tá»« $1$ tá»›i $ğ‘›$ vÃ  $ğ‘š$ con Ä‘Æ°á»ng Ä‘Ã¡nh sá»‘ tá»« $1$ tá»›i $ğ‘š$. Con Ä‘Æ°á»ng thá»© $ğ‘–$ cho phÃ©p Ä‘i tá»« Ä‘á»‹a Ä‘iá»ƒm $ğ‘¢_ğ‘–$ tá»›i Ä‘á»‹a Ä‘iá»ƒm $ğ‘£_ğ‘–$ theo má»™t chiá»u, Ä‘á»™ dÃ i con Ä‘Æ°á»ng lÃ  $ğ‘¤_ğ‘–$. Ban Ä‘áº§u cáº£ $ğ‘›$ Ä‘á»‹a Ä‘iá»ƒm Ä‘á»u bá»‹ khÃ³a. Khi má»™t Ä‘á»‹a Ä‘iá»ƒm bá»‹ khÃ³a, nÃ³ sáº½ khÃ´ng cho phÃ©p Ä‘i ra hay Ä‘i vÃ o theo báº¥t cá»© con Ä‘Æ°á»ng nÃ o liÃªn thuá»™c vá»›i nÃ³. NgÆ°á»£c láº¡i khi má»™t Ä‘á»‹a Ä‘iá»ƒm Ä‘Æ°á»£c má»Ÿ khÃ³a, ngÆ°á»i ta cÃ³ thá»ƒ thoÃ¡i mÃ¡i ra vÃ o nÃ³ báº±ng báº¥t ká»³ con Ä‘Æ°á»ng nÃ o (táº¥t nhiÃªn váº«n pháº£i Ä‘i theo chiá»u Ä‘Ã£ Ä‘á»‹nh cá»§a cÃ¡c con Ä‘Æ°á»ng, khÃ´ng Ä‘Æ°á»£c Ä‘i ngÆ°á»£c chiá»u).

GiÃ¡o sÆ° $X$ Ä‘Æ°á»£c má»™t nhÃ  thÃ¡m hiá»ƒm $Y$ nhá» dÃ¹ng mÃ¡y tÃ­nh má»Ÿ khÃ³a Ä‘á»ƒ thÃ¡m hiá»ƒm mÃª cung. Hai ngÆ°á»i trao Ä‘á»•i qua cÃ¡c thÃ´ng Ä‘iá»‡p thuá»™c má»™t trong hai dáº¡ng:
- GiÃ¡o sÆ° $X$: Äá»‹a Ä‘iá»ƒm $ğ‘–$ vá»«a Ä‘Æ°á»£c má»Ÿ khÃ³a;
- NhÃ  thÃ¡m hiá»ƒm $Y$: BÃ¢y giá» cÃ³ thá»ƒ Ä‘i tá»« $ğ‘ $ tá»›i $ğ‘¡$ hay khÃ´ng? Náº¿u Ä‘i Ä‘Æ°á»£c thÃ¬ Ä‘á»™ dÃ i con Ä‘Æ°á»ng ngáº¯n nháº¥t lÃ  bao nhiÃªu?

**YÃªu cáº§u:** Biáº¿t Ä‘Æ°á»£c $ğ‘˜$ thÃ´ng Ä‘iá»‡p vÃ  trÃ¬nh tá»± cá»§a chÃºng, hÃ£y giÃºp giÃ¡o sÆ° $X$ tráº£ lá»i táº¥t cáº£ cÃ¢u há»i cá»§a nhÃ  thÃ¡m hiá»ƒm $ğ‘Œ$.

## Dá»¯ liá»‡u vÃ o:
- DÃ²ng Ä‘áº§u chá»©a ba sá»‘ nguyÃªn dÆ°Æ¡ng $ğ‘› â‰¤ 300, ğ‘š, ğ‘˜ â‰¤ 10^5$;
- $ğ‘š$ dÃ²ng tiáº¿p theo, dÃ²ng thá»© $ğ‘–$ chá»©a ba sá»‘ nguyÃªn dÆ°Æ¡ng $ğ‘¢_ğ‘–, ğ‘£_ğ‘–, ğ‘¤_ğ‘–\ (âˆ€ğ‘–: ğ‘¤_ğ‘– â‰¤ 10^6)$;
- $ğ‘˜$ dÃ²ng tiáº¿p theo, má»—i dÃ²ng chá»©a má»™t thÃ´ng Ä‘iá»‡p, Ä‘áº§u dÃ²ng lÃ  kÃ½ tá»± $âˆˆ {ğ‘‹, ğ‘Œ}$ cho biáº¿t Ä‘Ã³ lÃ  thÃ´ng Ä‘iá»‡p cá»§a giÃ¡o 
sÆ° $X$ hay nhÃ  thÃ¡m Ä‘iá»ƒm $ğ‘Œ$. Náº¿u lÃ  thÃ´ng Ä‘iá»‡p cá»§a giÃ¡o sÆ° $X$, tiáº¿p theo lÃ  sá»‘ nguyÃªn $ğ‘–$ cho biáº¿t Ä‘á»‹a Ä‘iá»ƒm $ğ‘–$ vá»«a Ä‘Æ°á»£c má»Ÿ khÃ³a. Náº¿u lÃ  thÃ´ng Ä‘iá»‡p cá»§a nhÃ  thÃ¡m hiá»ƒm $ğ‘Œ$, tiáº¿p theo lÃ  hai sá»‘ nguyÃªn $ğ‘ , ğ‘¡$ á»©ng vá»›i cÃ¢u há»i hiá»‡n giá» cÃ³ thá»ƒ Ä‘i tá»« $ğ‘ $ tá»›i $ğ‘¡$ hay khÃ´ng?

## Dá»¯ liá»‡u ra:
- Vá»›i má»—i cÃ¢u há»i cá»§a nhÃ  thÃ¡m hiá»ƒm $ğ‘Œ$, ghi ra trÃªn má»™t dÃ²ng Ä‘á»™ dÃ i Ä‘Æ°á»ng Ä‘i ngáº¯n nháº¥t tá»« $ğ‘ $ tá»›i $ğ‘¡$ (náº¿u hiá»‡n táº¡i chÆ°a thá»ƒ Ä‘i tá»« $ğ‘ $ tá»›i $ğ‘¡$, in ra trÃªn dÃ²ng sá»‘ $-1$).

## VÃ­ dá»¥:
<center><img src="/images/problems/1214/DWLABYR.svg" width="300px" /></center>

#### Dá»¯ liá»‡u vÃ o:
```
5 5 7
1 2 10
3 1 20
2 4 30
2 5 40
3 2 50
X 1
X 4
X 2
Y 1 4
X 3
Y 3 4
Y 5 3
```

#### Dá»¯ liá»‡u ra:
```
40
60
-1
```