**<center>NGUá»’N: PVH PreVOI ONLINE 2020 (13 - 14/12/2019)</center>**
<br>

Nhá»¯ng baÌ£n Ä‘aÌƒ tÆ°Ì€ng gÄƒÌn boÌ vÆ¡Ìi VNOI Online qua nhiá»u nÄƒm hÄƒÌ‰n khÃ´ng há» xa laÌ£ vÆ¡Ìi BÄƒÌc Ninh â€“ trung tÃ¢m xÆ°Ì Kinh BÄƒÌc cÃ´Ì‰ xÆ°a, caÌi nÃ´i cuÌ‰a lÃ n Ä‘iÃªÌ£u dÃ¢n ca quan hoÌ£ Ä‘aÌƒ Ä‘Æ°Æ¡Ì£c UNESCO cÃ´ng nháº­n lÃ  Di saÌ‰n vÄƒn hoaÌ phi váº­t thÃªÌ‰. CaÌc baÌ£n cuÌƒng Ä‘aÌƒ biÃªÌt con ngÆ°á»i BÄƒÌc Ninh coÌ truyá»n thá»‘ng vÄƒn hoÃ¡, hiÃªÌu khÃ¡ch, cáº§n cÃ¹ vÃ  sÃ¡ng taÌ£o, vÆ¡Ìi nhá»¯ng bÃ n tay khÃ©o lÃ©o mang Ä‘áº­m nÃ©t dÃ¢n gian. CaÌc baÌ£n Ä‘aÌƒ Ä‘Æ°Æ¡Ì£c nghe vá» nhá»¯ng chiÃªÌc baÌnh phu thÃª vÃ ng Æ°Æ¡m, Ä‘Æ°Æ¡Ì£c xÃªÌp thÃ nh cÄƒÌ£p nhÆ° lá»i chuÌc phuÌc cho caÌc Ä‘Ã´i tÃ¢n lang, tÃ¢n nÆ°Æ¡ng trong ngÃ y cÆ°Æ¡Ìi. VÃ  cuá»‘i cuÌ€ng, caÌc baÌ£n hÄƒÌ‰n coÌ€n nhÆ¡Ì cÄƒÌ£p Ä‘Ã´i Liinhh vÃ  TrÃ , nhá»¯ng sÆ°Ì‰u nhi Ä‘aÌƒ gÃ¢y ra vuÌ£ cÆ°Æ¡Ìp Ä‘aÌm cÆ°Æ¡Ìi Ä‘iÌ€nh Ä‘aÌm, mÃ  chiÌ‰ coÌ nhá»¯ng láº­p triÌ€nh viÃªn thuáº­t toaÌn khuÌ‰ng mÆ¡Ìi coÌ thÃªÌ‰ cÆ°Ìu má»™t Ä‘aÌm cÆ°Æ¡Ìi trong lÃ ng khoÌ‰i thaÌ‰m hoaÌ£.

NÄƒm nay, TrÃ  ~18~ tuÃ´Ì‰i, Ä‘aÌƒ dáº­y thiÌ€ xong vÃ  lÃ  má»™t thiÃªÌu ná»¯ xinh Ä‘eÌ£p, diÌ£u hiá»n. TrÃ  Ä‘ÃªÌn tuÃ´Ì‰i lÃ¢Ìy chÃ´Ì€ng vÃ  chÄƒÌ‰ng mÃ¢Ìy chá»‘c Ä‘aÌƒ kiÃªÌm Ä‘Æ°Æ¡Ì£c cho miÌ€nh má»™t Ä‘Ã¢Ìng phu quÃ¢n hoÃ n haÌ‰o. ÄÃªÌ‰ khÃ©p laÌ£i quaÌ khÆ°Ì Ä‘en tá»‘i vÃ  vun vÃ©n cho cuá»™c sá»‘ng hÃ´n nhÃ¢n, TrÃ  quyÃªÌt Ä‘iÌ£nh tÆ°Ì€ mÄƒÌ£t Liinhh vÃ  khÃ´ng cho Liinhh tÆ¡Ìi dÆ°Ì£ Ä‘aÌm cÆ°Æ¡Ìi, duÌ€ hai ngÆ°á»i tÆ°Ì€ng ngÃ´Ì€i cuÌ€ng lÆ¡Ìp suá»‘t ba nÄƒm trá»i. TÆ°Ìc giáº­n trÆ°Æ¡Ìc sÆ°Ì£ trá»Ÿ mÄƒÌ£t cuÌ‰a ngÆ°á»i baÌ£n tá»‘t, Liinhh cÃ¢u kÃªÌt vÆ¡Ìi HÃ  Quang Miinhh, láº­p mÆ°u tiÌnh kÃªÌ Ä‘ÃªÌn dÆ°Ì£ Ä‘aÌm cÆ°Æ¡Ìi cuÌ‰a TrÃ , quyÃªÌt thÆ°Ì£c hiÃªÌ£n giaÌƒ tÃ¢m Äƒn trá»™m baÌnh phu thÃª, nhÆ° ngÃ y xÆ°a caÌ‰ há»™i cuÌ€ng lÃ m vÆ¡Ìi nhau.

DÆ°Æ¡Ìi sÆ°Ì£ aÌ‰nh hÆ°á»Ÿng cuÌ‰a cuá»™c caÌch maÌ£ng cÃ´ng nghiÃªÌ£p ~4.0~, thÃ nh phá»‘ BÄƒÌc Ninh giá» Ä‘Ã¢y Ä‘aÌƒ thay da Ä‘Ã´Ì‰i thiÌ£t. KhÃ´ng nhÆ° thÃ nh phá»‘ bÃªn caÌ£nh, nÆ¡i coÌ tuyÃªÌn Ä‘Æ°á»ng sÄƒÌt CaÌt Linh â€“ HÃ  ÄÃ´ng xÃ¢y ngoÌt tháº­p kyÌ‰ vÃ¢Ìƒn khÃ´ng xong, BÄƒÌc Ninh Ä‘aÌƒ coÌ hÃªÌ£ thá»‘ng Ä‘Æ°á»ng sÄƒÌt vÄƒn minh, hiÃªÌ£n Ä‘aÌ£i. ThÃ nh phá»‘ bao gÃ´Ì€m ~ğ‘›~ ga tÃ u Ä‘Æ°Æ¡Ì£c Ä‘aÌnh sá»‘ tÆ°Ì€ ~1~ tÆ¡Ìi ~ğ‘›~. CaÌc ga tÃ u Ä‘Æ°Æ¡Ì£c ná»‘i vÆ¡Ìi nhau bá»Ÿi ~ğ‘š~ tuyÃªÌn Ä‘Æ°á»ng sÄƒÌt má»™t chiá»u, tuyÃªÌ‰n thÆ°Ì ~ğ‘–~ Ä‘i tÆ°Ì€ ga ~ğ‘¢_ğ‘–~ tÆ¡Ìi ga ~ğ‘£_ğ‘–~ vÃ  coÌ chi phiÌ lÃ  ~ğ‘_ğ‘–~. Theo chiÌnh saÌch hiÃªÌ£n taÌ£i cuÌ‰a thÃ nh phá»‘, caÌc ga tÃ u aÌp duÌ£ng mÆ°Ìc phiÌ baÌ‰o triÌ€ hÃªÌ£ thá»‘ng láº§n lÆ°Æ¡Ì£t lÃ  ~ğ‘_1, ğ‘_2, â€¦ , ğ‘_ğ‘›~. ÄÃªÌ‰ Ä‘i tÆ°Ì€ ga ~ğ‘¥~ tÆ¡Ìi ga ~ğ‘¦~, hÃ nh khaÌch phaÌ‰i thÆ°Ì£c hiÃªÌ£n má»™t hÃ nh triÌ€nh gÃ´Ì€m má»™t chuÃ´Ìƒi caÌc chuyÃªÌn tÃ u, sao cho chuyÃªÌn Ä‘áº§u tiÃªn xuÃ¢Ìt phaÌt taÌ£i ~ğ‘¥~, chuyÃªÌn cuá»‘i cuÌ€ng kÃªÌt thuÌc taÌ£i ~ğ‘¦~ vÃ  Ä‘iÃªÌ‰m xuÃ¢Ìt phaÌt cuÌ‰a chuyÃªÌn liá»n sau truÌ€ng vÆ¡Ìi Ä‘iÃªÌ‰m kÃªÌt thuÌc cuÌ‰a chuyÃªÌn liá»n trÆ°Æ¡Ìc. Chi phiÌ cho má»™t hÃ nh triÌ€nh bao gÃ´Ì€m tÃ´Ì‰ng chi phiÌ cuÌ‰a caÌc tuyÃªÌn Ä‘Æ°á»ng sÄƒÌt Ä‘Æ°Æ¡Ì£c sÆ°Ì‰ duÌ£ng, cá»™ng thÃªm phiÌ baÌ‰o triÌ€ hÃªÌ£ thá»‘ng nhoÌ‰ nhÃ¢Ìt cuÌ‰a má»™t ga tÃ u Ä‘aÌƒ Ä‘i qua. NoÌi caÌch khaÌc, Ä‘ÃªÌ‰ thÆ°Ì£c hiÃªÌ£n má»™t hÃ nh triÌ€nh tÆ°Ì€ ga ğ‘¥ tÆ¡Ìi ga ~ğ‘¦~ vÆ¡Ìi ~ğ‘˜~ chuyÃªÌn tÃ u ~ğ‘–_1, ğ‘–_2, â€¦ , ğ‘–_ğ‘˜~ khaÌch phaÌ‰i traÌ‰ sá»‘ tiá»n lÃ : ~ğ‘_{ğ‘–_1} + ğ‘_{ğ‘–_2} + â‹¯ + ğ‘_{ğ‘–_ğ‘˜} + \minâ¡(ğ‘_ğ‘¥, ğ‘_ğ‘¦, ğ‘_{ğ‘¢_{ğ‘–_1}} , ğ‘_{ğ‘£_{ğ‘–_1}} , ğ‘_{ğ‘¢_{ğ‘–_2}} , ğ‘_{ğ‘£_{ğ‘–_2}} , â€¦ , ğ‘_{ğ‘¢_{ğ‘–_ğ‘˜}} , ğ‘_{ğ‘£_{ğ‘–_ğ‘˜}})~

LÆ°u yÌ rÄƒÌ€ng trong má»™t hÃ nh triÌ€nh, má»™t chuyÃªÌn tÃ u coÌ thÃªÌ‰ Ä‘Æ°Æ¡Ì£c Ä‘i nhiá»u láº§n, vÃ  baÌ£n phaÌ‰i traÌ‰ phiÌ cho mÃ´Ìƒi láº§n baÌ£n Ä‘i. PhiÌ baÌ‰o triÌ€ hÃªÌ£ thá»‘ng cuÌ‰a má»™t sá»‘ ga tÃ u coÌ thÃªÌ‰ Ã¢m â€“ Ä‘Ã¢y lÃ  yÌ tÆ°á»Ÿng thu huÌt  ngÆ°á»i dÃ¢n Ä‘i tÃ u cuÌ‰a thÃ nh phá»‘, bá»Ÿi sá»‘ tiá»n baÌ£n boÌ‰ ra coÌ thÃªÌ‰ iÌt hÆ¡n tÃ´Ì‰ng chi phiÌ cuÌ‰a caÌc chuyÃªÌn tÃ u baÌ£n sÆ°Ì‰ duÌ£ng.

TrÆ°á»ng THPT chuyÃªn BÄƒÌc Ninh nÄƒÌ€m gáº§n ga tÃ u ~ğ‘ ~. ÄÃªÌ‰ caÌc baÌ£n coÌ thÃªÌ‰ tÆ¡Ìi dÆ°Ì£ Ä‘aÌm cÆ°Æ¡Ìi, TrÃ  muá»‘n tÃ´Ì‰ chÆ°Ìc hÃ´n lÃªÌƒ á»Ÿ gáº§n má»™t ga tÃ u ~ğ‘¡~ mÃ  coÌ thÃªÌ‰ Ä‘i bÄƒÌ€ng tÃ u tÆ°Ì€ ga ~ğ‘ ~ tÆ¡Ìi ga ~ğ‘¡~. NhÆ°ng Ä‘ÃªÌ‰ gÃ¢y khoÌ khÄƒn cho Liinhh vÃ  Miinh, viÌ€ biÃªÌt Ä‘Ã¢y lÃ  hai hoÌ£c sinh ngheÌ€o vÆ°Æ¡Ì£t khoÌ, TrÃ  muá»‘n choÌ£n ga ~ğ‘¡~ sao cho chi phiÌ nhoÌ‰ nhÃ¢Ìt cho má»™t hÃ nh triÌ€nh tÆ°Ì€ ga ~ğ‘ ~ tÆ¡Ìi ga ~ğ‘¡~ lÃ  lÆ¡Ìn nhÃ¢Ìt coÌ thÃªÌ‰.

CaÌc baÌ£n haÌƒy giuÌp TrÃ  baÌ‰o vÃªÌ£ sÆ°Ì£ biÌ€nh an cuÌ‰a Ä‘aÌm cÆ°Æ¡Ìi nÃ y, bÄƒÌ€ng viÃªÌ£c chiÌ‰ ra cho trÃ  má»™t Ä‘iÌ£a Ä‘iÃªÌ‰m tÃ´Ì‰ chÆ°Ìc Ä‘aÌm cÆ°Æ¡Ìi thiÌch hÆ¡Ì£p, vÃ  má»™t hÃ nh triÌ€nh coÌ chi phiÌ nhoÌ‰ nhÃ¢Ìt Ä‘ÃªÌ‰ Ä‘i tÆ°Ì€ trÆ°á»ng THPT chuyÃªn BÄƒÌc Ninh tÆ¡Ìi Ä‘Ã¢y nhÃ©.

## Dá»¯ liá»‡u vÃ o:
- DoÌ€ng Ä‘áº§u tiÃªn chÆ°Ìa ba sá»‘ nguyÃªn ~ğ‘›, ğ‘š~ vÃ  ~ğ‘ ~ ~(1 â‰¤ ğ‘›, ğ‘š â‰¤ 3 \times 10^5, 1 â‰¤ ğ‘  â‰¤ ğ‘›)~ lÃ  sá»‘ ga tÃ u trong thÃ nh phá»‘, sá»‘ tuyÃªÌn Ä‘Æ°á»ng sÄƒÌt vÃ  ga tÃ u nÄƒÌ€m gáº§n trÆ°á»ng THPT chuyÃªn BÄƒÌc Ninh.
- DoÌ€ng thÆ°Ì hai chÆ°Ìa ~ğ‘›~ sá»‘ nguyÃªn ~ğ‘_1, ğ‘_2, â€¦ , ğ‘_ğ‘›~ ~(âˆ’10^9 â‰¤ ğ‘_ğ‘– â‰¤ 10^9)~ lÃ  phiÌ baÌ‰o triÌ€ hÃªÌ£ thá»‘ng cuÌ‰a ~ğ‘›~ ga tÃ u.
- Trong ~ğ‘š~ doÌ€ng cuá»‘i, doÌ€ng thÆ°Ì ~ğ‘–~ chÆ°Ìa ba sá»‘ nguyÃªn ~ğ‘¢_ğ‘–, ğ‘£_ğ‘–~ vÃ  ~ğ‘_ğ‘–~ ~(1 â‰¤ ğ‘¢_ğ‘–, ğ‘£_ğ‘– â‰¤ ğ‘›, 1 â‰¤ ğ‘_ğ‘– â‰¤ 10^9)~ lÃ  ga xuÃ¢Ìt phaÌt, ga kÃªÌt thuÌc vÃ  chi phiÌ cuÌ‰a chuyÃªÌn tÃ u thÆ°Ì ~ğ‘–~.

## Dá»¯ liá»‡u ra:
- DoÌ€ng Ä‘áº§u tiÃªn chÆ°Ìa hai sá»‘ nguyÃªn ~ğ‘‘~ vÃ  ~ğ‘¡~ ~(1 â‰¤ ğ‘¡ â‰¤ ğ‘›)~, trong Ä‘oÌ ~ğ‘¡~ lÃ  ga tÃ u mÃ  TrÃ  nÃªn tÃ´Ì‰ chÆ°Ìc Ä‘aÌm cÆ°Æ¡Ìi gáº§n Ä‘oÌ vÃ  ~ğ‘‘~ lÃ  chi phiÌ nhoÌ‰ nhÃ¢Ìt Ä‘ÃªÌ‰ di chuyÃªÌ‰n bÄƒÌ€ng tÃ u tÆ°Ì€ ga ~ğ‘ ~ tÆ¡Ìi ga ~ğ‘¡~.
- DoÌ€ng thÆ°Ì hai chÆ°Ìa sá»‘ nguyÃªn khÃ´ng Ã¢m ~ğ‘˜~ lÃ  sá»‘ chuyÃªÌn tÃ u trÃªn hÃ nh triÌ€nh tÆ°Ì€ ga ~ğ‘ ~ tÆ¡Ìi ga ~ğ‘¡~ vÆ¡Ìi chi phiÌ nhoÌ‰ nhÃ¢Ìt.
- DoÌ€ng thÆ°Ì ba chÆ°Ìa ~ğ‘˜~ sá»‘ nguyÃªn dÆ°Æ¡ng ~ğ‘–_1, ğ‘–_2 â€¦ , ğ‘–_ğ‘˜~ ~(1 â‰¤ ğ‘–_ğ‘— â‰¤ ğ‘š)~ lÃ  chiÌ‰ sá»‘ cuÌ‰a caÌc chuyÃªÌn tÃ u trÃªn hÃ nh triÌ€nh.
NÃªÌu coÌ nhiá»u Ä‘aÌp aÌn tá»‘i Æ°u, baÌ£n coÌ thÃªÌ‰ in ra phÆ°Æ¡ng aÌn bÃ¢Ìt kiÌ€.

## Giá»›i háº¡n:
- **Subtask** ~\#1~ ~(20\%\text{ sá»‘ Ä‘iá»ƒm}): 0 â‰¤ ğ‘_ğ‘– â‰¤ 10~ 
- **Subtask** ~\#2~ ~(20\%\text{ sá»‘ Ä‘iá»ƒm}): ğ‘›, ğ‘š â‰¤ 2000~
- **Subtask** ~\#3~ ~(60\%\text{ sá»‘ Ä‘iá»ƒm}):~ â¡KhÃ´ng coÌ rÃ ng buá»™c giÌ€ thÃªm

## VÃ­ dá»¥:
#### Dá»¯ liá»‡u vÃ o:
```
4 4 1
10 0 20 30
1 2 7
1 3 4
2 4 8
3 4 6
```

#### Dá»¯ liá»‡u ra:
```
15 4
2
1 3
```

#### Dá»¯ liá»‡u vÃ o:
```
5 7 3
1 2 -4 -8 16
2 4 10
4 3 7
1 5 2
2 3 1
5 2 10
1 2 5
5 4 3
```

#### Dá»¯ liá»‡u ra:
```
-4 3
0
```

#### Giáº£i thÃ­ch:
<center><img src="/images/problems/1170/railway.png" width=400px></center>

- Trong viÌ duÌ£ thÆ°Ì nhÃ¢Ìt (hiÌ€nh minh hoaÌ£):
    - HÃ nh triÌ€nh mÃ u xanh Ä‘i qua caÌc ga ~1, 2, 4~ nÃªn coÌ chi phiÌ lÃ  ~7 + 8 + \min(ğ‘_1, ğ‘_2, ğ‘_4) = 15~ 
    - HÃ nh triÌ€nh mÃ u Ä‘oÌ‰ Ä‘i qua caÌc ga ~1, 3, 4~ nÃªn coÌ chi phiÌ lÃ  ~4 + 6 + \min(ğ‘_1, ğ‘_3, ğ‘_4) = 20~
    - Chi phiÌ nhoÌ‰ nhÃ¢Ìt Ä‘ÃªÌ‰ Ä‘i tÆ°Ì€ ga ~1~ tÆ¡Ìi ga ~2~ lÃ  ~7~ 
    - Chi phiÌ nhoÌ‰ nhÃ¢Ìt Ä‘ÃªÌ‰ Ä‘i tÆ°Ì€ ga ~1~ tÆ¡Ìi ga ~3~ lÃ  ~14~
    - Chi phiÌ nhoÌ‰ nhÃ¢Ìt Ä‘ÃªÌ‰ Ä‘i tÆ°Ì€ ga ~1~ tÆ¡Ìi ga ~4~ lÃ  ~15~
    Váº­y TrÃ  nÃªn choÌ£n ga 4 Ä‘ÃªÌ‰ tÃ´Ì‰ chÆ°Ìc Ä‘aÌm cÆ°Æ¡Ìi. 

- Trong viÌ duÌ£ thÆ°Ì hai, tÆ°Ì€ trÆ°á»ng THPT chuyÃªn BÄƒÌc Ninh (ga ~3~) khÃ´ng tÆ¡Ìi Ä‘Æ°Æ¡Ì£c bÃ¢Ìt kiÌ€ ga nÃ o khaÌc. Do Ä‘oÌ, TrÃ  phaÌ‰i tÃ´Ì‰ chÆ°Ìc Ä‘aÌm cÆ°Æ¡Ìi á»Ÿ gáº§n ga nÃ y.
    - HÃ nh triÌ€nh Ä‘ÃªÌ‰ Ä‘i tÃ u tÆ°Ì€ ga ~3~ tÆ¡Ìi ga ~3~ khÃ´ng chÆ°Ìa chuyÃªÌn tÃ u nÃ o, nhÆ°ng vÃ¢Ìƒn chÆ°Ìa ga ~3~, nÃªn coÌ tÃ´Ì‰ng chi phiÌ lÃ  ~ğ‘_3 = âˆ’4~