Cuá»™i cÃ ng ngÃ y cÃ ng trá»Ÿ nÃªn nghiá»‡n Vietlott, má»™t trÃ² chÆ¡i xá»• sá»‘ may rá»§i Ä‘Ã£ xuáº¥t hiá»‡n táº¡i ViÃªt Nam Ä‘Æ°á»£c vÃ i nÄƒm nay. TrÃ² xá»• sá»‘ diá»…n ra nhÆ° sau:
- Cuá»™i sáº½ Ä‘áº¿n vÄƒn phÃ²ng xá»• sá»‘ gáº§n nháº¥t cá»§a Vietlott vÃ  chá»n loáº¡i giáº£i mÃ¬nh sáº½ tham gia, má»—i loáº¡i giáº£i cá»§a Vietlott tÆ°Æ¡ng á»©ng vá»›i Ä‘á»™ dÃ i cá»§a dÃ£y sá»‘ trÃªn tá» vÃ© sá»‘ Cuá»™i sáº½ mua. Cuá»™i cÃ³ thá»ƒ mua nhiá»u tá» vÃ© sá»‘ tÃ¹y Ã½.
- VÃ o cuá»‘i ngÃ y, cÃ´ng ty Vietlott, vá»›i má»—i loáº¡i giáº£i cÃ´ng ty sáº½ quay sá»‘ Ä‘á»ƒ tÃ¬m ra má»™t dÃ£y sá»‘ may máº¯n á»©ng vá»›i tá»«ng loáº¡i giáº£i.

Táº¥t nhiÃªn, Cuá»™i sáº½ giÃ nh Ä‘Æ°á»£c giáº£i Ä‘áº·c biá»‡t náº¿u má»™t trong nhá»¯ng tá» vÃ© sá»‘ anh áº¥y Ä‘Ã£ mua cÃ³ dÃ£y sá»‘ trÃ¹ng vá»›i dÃ£y sá»‘ may máº¯n á»©ng vá»›i loáº¡i giáº£i cá»§a tá» vÃ© sá»‘ Ä‘Ã³ mÃ  cÃ´ng ty Vietlott quay ra. Báº¡n cá»§a Cuá»™i lÃ  Bá»m lÃ m trong cÃ´ng ty Vietlott Ä‘Ã£ quyáº¿t Ä‘á»‹nh giÃºp cáº­u báº±ng cÃ¡ch nÃ³i cho cáº­u biáº¿t má»™t sá»‘
Ä‘áº·c Ä‘iá»ƒm cá»§a má»™t dÃ£y sá»‘ may máº¯n:
- DÃ£y sá»‘ chá»‰ bao gá»“m cÃ¡c sá»‘ tá»± nhiÃªn tá»« khoáº£ng ~[1, ğ‘]~;
- Táº¥t cáº£ cÃ¡c sá»‘ trong dÃ£y sá»‘ lÃ  phÃ¢n biá»‡t.
- Hai sá»‘ liÃªn tiáº¿p trong dÃ£y Ä‘á»u náº±m trong danh sÃ¡ch cÃ¡c cáº·p sá»‘ Ä‘Æ°á»£c phÃ©p Ä‘á»©ng cáº¡nh nhau trong dÃ£y. Danh sÃ¡ch cÃ¡c cáº·p sá»‘ Ä‘Æ°á»£c phÃ©p Ä‘á»©ng cáº¡nh nhau cÃ³ Ä‘áº·c Ä‘iá»ƒm sau:
    - LÃ  má»™t táº­p cÃ¡c cáº·p sá»‘ khÃ¡c nhau trong khoáº£ng ~[1, ğ‘]~. VÃ  náº¿u ta coi má»—i cáº·p sá»‘ lÃ  má»™t cáº¡nh cá»§a má»™t Ä‘á»“ thá»‹ thÃ¬:
    - Äá»“ thá»‹ táº¡o bá»Ÿi táº­p cÃ¡c cáº·p sá»‘ Ä‘Æ°á»£c phÃ©p Ä‘á»©ng cáº¡nh nhau lÃ  má»™t Ä‘á»“ thá»‹ khÃ´ng cÃ³ cáº¡nh nÃ o náº±m trong nhiá»u hÆ¡n má»™t chu trÃ¬nh Ä‘Æ¡n.

Bá»m Ä‘Ã£ Ä‘Æ°a cho Cuá»™i má»™t danh sÃ¡ch cÃ¡c cáº·p sá»‘ Ä‘Æ°á»£c phÃ©p Ä‘á»©ng cáº¡nh nhau vÃ  Cuá»™i quyáº¿t Ä‘á»‹nh ngÃ y mai, Cuá»™i sáº½ mua sá»‘ lÆ°á»£ng vÃ© báº±ng táº¥t cáº£ cÃ¡c dÃ£y may máº¯n cÃ³ thá»ƒ xuáº¥t hiá»‡n cá»§a má»™t loáº¡i giáº£i Ä‘á»ƒ cháº¯c cháº¯n giÃ nh Ä‘Æ°á»£c giáº£i thÆ°á»Ÿng. NhÆ°ng trÆ°á»›c Ä‘Ã³, anh áº¥y cáº§n biáº¿t loáº¡i giáº£i nÃ o sáº½ giÃºp anh áº¥y cÃ³ lá»£i nháº¥t, Ä‘á»ƒ biáº¿t Ä‘Æ°á»£c Ä‘iá»u nÃ y anh áº¥y cáº§n tÃ­nh toÃ¡n vá»›i má»—i loáº¡i giáº£i sáº½ cÃ³ bao nhiÃªu dÃ£y sá»‘ may máº¯n cÃ³ thá»ƒ quay ra tÆ°Æ¡ng á»©ng vá»›i loáº¡i giáº£i Ä‘Ã³. Sáº½ cÃ³ Ä‘Ãºng ~ğ‘~ loáº¡i giáº£i tÆ°Æ¡ng á»©ng vá»›i Ä‘á»™ dÃ i tá»« ~1~ Ä‘áº¿n ~ğ‘~ cá»§a dÃ£y sá»‘ may máº¯n. ÄÃ¢y khÃ´ng pháº£i má»™t Ä‘iá»u dá»… dÃ ng Ä‘á»‘i vá»›i Cuá»™i, nÃªn anh áº¥y muá»‘n nhá» cÃ¡c báº¡n tÃ­nh há»™ anh áº¥y xem á»©ng vá»›i má»—i Ä‘á»™ dÃ i ~ğ¿~ trong khoáº£ng tá»« ~1~ Ä‘áº¿n ~ğ‘~ cÃ³ táº¥t cáº£ bao nhiÃªu dÃ£y sá»‘ may máº¯n cÃ³ Ä‘á»™ dÃ i lÃ  ~ğ¿~.

**YÃªu cáº§u:** vá»›i giÃ¡ trá»‹ ~ğ¿~ tá»« ~1~ Ä‘áº¿n ~ğ‘~ Ä‘áº¿m xem cÃ³ bao nhiÃªu dÃ£y sá»‘ may máº¯n cÃ³ Ä‘á»™ dÃ i Ä‘Ãºng báº±ng ~ğ¿~.

## Dá»¯ liá»‡u vÃ o:
- DÃ²ng Ä‘áº§u tiÃªn chá»©a hai sá»‘ nguyÃªn ~ğ‘~ vÃ  ~ğ‘€\ (1 â‰¤ ğ‘ â‰¤ 4000, 0 â‰¤ ğ‘€ â‰¤ 10^5)~;
- ~ğ‘€~ dÃ²ng tiáº¿p theo má»—i dÃ²ng mÃ´ táº£ má»™t cáº·p sá»‘ cÃ³ thá»ƒ Ä‘á»©ng cáº¡nh nhau. Dá»¯ liá»‡u Ä‘áº£m báº£o khÃ´ng cÃ³ cáº·p sá»‘ nÃ o xuáº¥t hiá»‡n quÃ¡ má»™t láº§n trong dá»¯ liá»‡u.

## Dá»¯ liá»‡u ra:
- Ghi ra trÃªn má»™t dÃ²ng gá»“m ~ğ‘~ sá»‘ nguyÃªn, sá»‘ thá»© ~ğ‘–~ lÃ  káº¿t quáº£ sá»‘ dÃ£y may máº¯n cÃ³ Ä‘á»™ dÃ i ~ğ‘–~ láº¥y pháº§n dÆ° cho ~10^9 + 7~.

## VÃ­ dá»¥:
#### Dá»¯ liá»‡u vÃ o:
```
3 2
1 2
2 3
```

#### Dá»¯ liá»‡u ra:
```
3 4 2
```

#### Dá»¯ liá»‡u vÃ o:
```
3 3
1 3
2 3
1 2
```

#### Dá»¯ liá»‡u ra:
```
3 6 6
```

**Giáº£i thÃ­ch**: Vá»›i vÃ­ dá»¥ Ä‘áº§u tiÃªn cÃ¡c dÃ£y may máº¯n cÃ³ thá»ƒ cÃ³ Ä‘á»™ dÃ i ~1~ lÃ  ~(1), (2), (3)~; Ä‘á»™ dÃ i ~2~ lÃ  ~(1, 2), (2, 3), (2, 1) vÃ  (3, 2)~; Ä‘á»™ dÃ i ~3~ lÃ  ~(1, 2, 3)~ vÃ  ~(3, 2, 1)~.

## Giá»›i háº¡n:
- CÃ³ ~25\%~ sá»‘ Ä‘iá»ƒm cÃ³ ~ğ‘ â‰¤ 10~;
- CÃ³ ~25\%~ sá»‘ Ä‘iá»ƒm tiáº¿p theo Ä‘á»“ thá»‹ trong dá»¯ liá»‡u sáº½ cÃ³ dáº¡ng khÃ´ng cÃ³ chu trÃ¬nh;
- CÃ³ ~25\%~ sá»‘ Ä‘iá»ƒm tiáº¿p theo Ä‘á»“ thá»‹ trong dá»¯ liá»‡u cÃ³ dáº¡ng má»—i Ä‘á»‰nh thuá»™c khÃ´ng quÃ¡ má»™t chu trÃ¬nh Ä‘Æ¡n.
- CÃ³ ~25\%~ sá»‘ Ä‘iá»ƒm cÃ²n láº¡i khÃ´ng cÃ³ rÃ ng buá»™c gÃ¬ thÃªm.